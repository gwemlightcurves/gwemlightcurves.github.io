

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>gwemlightcurves.KNModels.table &mdash; gwemlightcurves 0+untagged.134.gbc97269.dirty documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/gwemlightcurves-docs.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="gwemlightcurves 0+untagged.134.gbc97269.dirty documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> gwemlightcurves
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.134.gbc97269.dirty
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Simulating a Kilonova Lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/lightcurves.html">Lightcurves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/eos.html">Equation of State</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../command-line/index.html">Running <code class="docutils literal"><span class="pre">run_parameterized_models_event.py</span></code> on the command line</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">gwemlightcurves</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>gwemlightcurves.KNModels.table</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for gwemlightcurves.KNModels.table</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (C) Scott Coughlin (2017)</span>
<span class="c1">#</span>
<span class="c1"># This file is part of gwemlightcurves.</span>
<span class="c1">#</span>
<span class="c1"># gwemlightcurves is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># gwemlightcurves is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with gwemlightcurves.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">&quot;&quot;&quot;Extend :mod:`astropy.table` with the `KNTable`</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="k">import</span> <span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">vstack</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">distutils.spawn</span> <span class="k">import</span> <span class="n">find_executable</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Scott Coughlin &lt;scott.coughlin@ligo.org&gt;&#39;</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KNTable&#39;</span><span class="p">,</span> <span class="s1">&#39;tidal_lambda_from_tilde&#39;</span><span class="p">,</span> <span class="s1">&#39;CLove&#39;</span><span class="p">,</span> <span class="s1">&#39;EOSfit&#39;</span><span class="p">,</span> <span class="s1">&#39;get_eos_list&#39;</span><span class="p">,</span> <span class="s1">&#39;get_lalsim_eos&#39;</span><span class="p">,</span> <span class="s1">&#39;construct_eos_from_polytrope&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="tidal_lambda_from_tilde"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.tidal_lambda_from_tilde">[docs]</a><span class="k">def</span> <span class="nf">tidal_lambda_from_tilde</span><span class="p">(</span><span class="n">mass1</span><span class="p">,</span> <span class="n">mass2</span><span class="p">,</span> <span class="n">lam_til</span><span class="p">,</span> <span class="n">dlam_til</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine physical lambda parameters from effective parameters.</span>
<span class="sd">    See Eqs. 5 and 6 from</span>
<span class="sd">    https://journals.aps.org/prd/pdf/10.1103/PhysRevD.89.103012</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mt</span> <span class="o">=</span> <span class="n">mass1</span> <span class="o">+</span> <span class="n">mass2</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="n">mass1</span> <span class="o">*</span> <span class="n">mass2</span> <span class="o">/</span> <span class="n">mt</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mf">8.</span><span class="o">/</span><span class="mi">13</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">eta</span> <span class="o">-</span> <span class="mi">31</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mf">8.</span><span class="o">/</span><span class="mi">13</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">eta</span> <span class="o">-</span> <span class="mi">11</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">13272</span><span class="o">*</span><span class="n">eta</span><span class="o">/</span><span class="mi">1319</span> <span class="o">+</span> <span class="mi">8944</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">1319</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">15910</span><span class="o">*</span><span class="n">eta</span><span class="o">/</span><span class="mi">1319</span> <span class="o">+</span> <span class="mi">32850</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">1319</span> <span class="o">+</span> <span class="mi">3380</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">1319</span><span class="p">)</span>

    <span class="n">lambda1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">lam_til</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">dlam_til</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
    <span class="n">lambda2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">lam_til</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">dlam_til</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">d</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lambda1</span><span class="p">,</span> <span class="n">lambda2</span></div>

<div class="viewcode-block" id="CLove"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.CLove">[docs]</a><span class="k">def</span> <span class="nf">CLove</span><span class="p">(</span><span class="n">lmbda</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compactness-Love relation for neutron stars from Eq. (78) of Yagi and Yunes, Phys. Rep. 681, 1 (2017), using the YY coefficients and capping the compactness at the Buchdahl limit of 4/9 = 0.44... (since the fit diverges as lambda \to 0). We also cap the compactness at zero, since it becomes negative for large lambda, though these lambdas are so large that they are unlikely to be encountered in practice. In both cases, we raise an error if it runs up against either of the bounds.</span>

<span class="sd">    Input: Dimensionless quadrupolar tidal deformability lmbda</span>
<span class="sd">    Output: Compactness (mass over radius, in geometrized units, so the result is dimensionless)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Give coefficients</span>
    <span class="n">a0</span> <span class="o">=</span> <span class="mf">0.360</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0355</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.000705</span>

    <span class="c1"># Compute fit</span>
    <span class="n">lmbda</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">lmbda</span><span class="p">)</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">lmbda</span><span class="p">)</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">ll</span><span class="p">)</span><span class="o">*</span><span class="n">ll</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">cc</span> <span class="o">&gt;</span> <span class="mf">4.</span><span class="o">/</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Returned compactnesses &gt; 4/9 = 0.44 ... setting = 4/9&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;setting compact value of </span><span class="si">{0}</span><span class="s2"> for lambda </span><span class="si">{1}</span><span class="s2"> to 4/9&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="n">cc</span> <span class="o">&gt;</span> <span class="mf">4.</span><span class="o">/</span><span class="mf">9.</span><span class="p">],</span> <span class="n">lmbda</span><span class="p">[</span><span class="n">cc</span> <span class="o">&gt;</span> <span class="mf">4.</span><span class="o">/</span><span class="mf">9.</span><span class="p">]))</span>
            <span class="n">cc</span><span class="p">[</span><span class="n">cc</span> <span class="o">&gt;</span> <span class="mf">4.</span><span class="o">/</span><span class="mf">9.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">/</span><span class="mf">9.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cc</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Returned compactnesses &lt; 0 ... setting = 0.&quot;</span><span class="p">)</span>
            <span class="n">cc</span><span class="p">[</span><span class="n">cc</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">return</span> <span class="n">cc</span></div>

<div class="viewcode-block" id="EOSfit"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.EOSfit">[docs]</a><span class="k">def</span> <span class="nf">EOSfit</span><span class="p">(</span><span class="n">mns</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # Equation to relate EOS and neutron star mass to Baryonic mass</span>
<span class="sd">    # Eq 8: https://arxiv.org/pdf/1708.07714.pdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mb</span> <span class="o">=</span> <span class="n">mns</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.8857853174243745</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mf">1.2082383572002926</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mb</span></div>


<div class="viewcode-block" id="get_eos_list"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.get_eos_list">[docs]</a><span class="k">def</span> <span class="nf">get_eos_list</span><span class="p">(</span><span class="n">TOV</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populates lists of available EOSs for each set of TOV solvers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="k">if</span> <span class="n">TOV</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Monica&#39;</span><span class="p">,</span> <span class="s1">&#39;Wolfgang&#39;</span><span class="p">,</span> <span class="s1">&#39;lalsim&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have provided a TOV &#39;</span>
                         <span class="s1">&#39;for which we have no data &#39;</span>
                         <span class="s1">&#39;and therefore cannot &#39;</span>
                         <span class="s1">&#39;calculate the radius.&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">find_executable</span><span class="p">(</span><span class="s1">&#39;ap4_mr.dat&#39;</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
       <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Check to make sure EOS mass-radius &#39;</span>
                        <span class="s1">&#39;tables have been installed correctly &#39;</span>
                        <span class="s1">&#39;(try `which ap4_mr.dat`)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;Monica&#39;</span><span class="p">:</span>
        <span class="n">EOS_List</span><span class="o">=</span><span class="p">[</span><span class="n">file_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_mr.dat&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;lalsim&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_name</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;Wolfgang&#39;</span><span class="p">:</span>
        <span class="n">EOS_List</span><span class="o">=</span><span class="p">[</span><span class="n">file_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;seq&quot;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;lalsim&#39;</span><span class="p">:</span>
        <span class="n">EOS_List</span><span class="o">=</span><span class="p">[</span><span class="n">file_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">14</span><span class="p">]</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;lalsim_mr.dat&quot;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">EOS_List</span></div>

<div class="viewcode-block" id="construct_eos_from_polytrope"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.construct_eos_from_polytrope">[docs]</a><span class="k">def</span> <span class="nf">construct_eos_from_polytrope</span><span class="p">(</span><span class="n">EOS</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses lalsimulation to read polytrope parameters from table</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">lalsimulation</span> <span class="k">as</span> <span class="nn">lalsim</span>
    <span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">ascii</span>
    <span class="n">polytrope_table</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">find_executable</span><span class="p">(</span><span class="s1">&#39;polytrope_table.dat&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;|S10&quot;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="c1">#convert all eos names to lower case</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;eos&#39;</span><span class="p">])):</span>
        <span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;eos&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;eos&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1">#convert logp from cgs to si</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;logP1&#39;</span><span class="p">])):</span>
        <span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;logP1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;logP1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">eos_indx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;eos&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">eos</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">eos</span><span class="o">=</span><span class="n">lalsim</span><span class="o">.</span><span class="n">SimNeutronStarEOS4ParameterPiecewisePolytrope</span><span class="p">(</span><span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;logP1&#39;</span><span class="p">][</span><span class="n">eos_indx</span><span class="p">],</span> <span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;gamma1&#39;</span><span class="p">][</span><span class="n">eos_indx</span><span class="p">],</span> <span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;gamma2&#39;</span><span class="p">][</span><span class="n">eos_indx</span><span class="p">],</span> <span class="n">polytrope_table</span><span class="p">[</span><span class="s1">&#39;gamma3&#39;</span><span class="p">][</span><span class="n">eos_indx</span><span class="p">])</span>
    <span class="n">eos_fam</span><span class="o">=</span><span class="n">lalsim</span><span class="o">.</span><span class="n">CreateSimNeutronStarFamily</span><span class="p">(</span><span class="n">eos</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">eos_fam</span></div>


<div class="viewcode-block" id="get_lalsim_eos"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.get_lalsim_eos">[docs]</a><span class="k">def</span> <span class="nf">get_lalsim_eos</span><span class="p">(</span><span class="n">eos_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    EOS tables described by Ozel `here &lt;https://arxiv.org/pdf/1603.02698.pdf&gt;`_ and downloadable `here &lt;http://xtreme.as.arizona.edu/NeutronStars/data/eos_tables.tar&gt;`_. LALSim utilizes this tables, but needs some interfacing (i.e. conversion to SI units, and conversion from non monotonic to monotonic pressure density tables)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs_max_mass</span> <span class="o">=</span> <span class="mf">2.01</span> <span class="o">-</span> <span class="mf">0.04</span>
    <span class="nb">print</span> <span class="s2">&quot;Checking </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eos_name</span>
    <span class="n">eos_fname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">eos_name</span><span class="p">):</span>
        <span class="c1"># NOTE: Adapted from code by Monica Rizzo</span>
        <span class="nb">print</span> <span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eos_name</span>
        <span class="n">bdens</span><span class="p">,</span> <span class="n">press</span><span class="p">,</span> <span class="n">edens</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">eos_name</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">press</span> <span class="o">*=</span> <span class="mf">7.42591549e-25</span>
        <span class="n">edens</span> <span class="o">*=</span> <span class="mf">7.42591549e-25</span>
        <span class="n">eos_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">eos_name</span><span class="p">)</span>
        <span class="n">eos_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">eos_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">press</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">keep_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">press</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">keep_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">0</span><span class="p">],</span> <span class="n">keep_idx</span><span class="p">))</span>
            <span class="n">press</span> <span class="o">=</span> <span class="n">press</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>
            <span class="n">edens</span> <span class="o">=</span> <span class="n">edens</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">press</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">edens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">keep_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">edens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">keep_idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">0</span><span class="p">],</span> <span class="n">keep_idx</span><span class="p">))</span>
            <span class="n">press</span> <span class="o">=</span> <span class="n">press</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>
            <span class="n">edens</span> <span class="o">=</span> <span class="n">edens</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">edens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

        <span class="nb">print</span> <span class="s2">&quot;Dumping to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eos_fname</span>
        <span class="n">eos_fname</span> <span class="o">=</span> <span class="s2">&quot;./.&quot;</span> <span class="o">+</span> <span class="n">eos_name</span> <span class="o">+</span> <span class="s2">&quot;.dat&quot;</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">eos_fname</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="n">press</span><span class="p">,</span> <span class="n">edens</span><span class="p">)),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">eos</span> <span class="o">=</span> <span class="n">lalsimulation</span><span class="o">.</span><span class="n">SimNeutronStarEOSFromFile</span><span class="p">(</span><span class="n">eos_fname</span><span class="p">)</span>
        <span class="n">fam</span> <span class="o">=</span> <span class="n">lalsimulation</span><span class="o">.</span><span class="n">CreateSimNeutronStarFamily</span><span class="p">(</span><span class="n">eos</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">eos</span> <span class="o">=</span> <span class="n">lalsimulation</span><span class="o">.</span><span class="n">SimNeutronStarEOSByName</span><span class="p">(</span><span class="n">eos_name</span><span class="p">)</span>
        <span class="n">fam</span> <span class="o">=</span> <span class="n">lalsimulation</span><span class="o">.</span><span class="n">CreateSimNeutronStarFamily</span><span class="p">(</span><span class="n">eos</span><span class="p">)</span>

    <span class="n">mmass</span> <span class="o">=</span> <span class="n">lalsimulation</span><span class="o">.</span><span class="n">SimNeutronStarMaximumMass</span><span class="p">(</span><span class="n">fam</span><span class="p">)</span> <span class="o">/</span> <span class="n">lal</span><span class="o">.</span><span class="n">MSUN_SI</span>
    <span class="nb">print</span> <span class="s2">&quot;Family </span><span class="si">%s</span><span class="s2">, maximum mass: </span><span class="si">%1.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eos_name</span><span class="p">,</span> <span class="n">mmass</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mmass</span><span class="p">)</span> <span class="ow">or</span> <span class="n">mmass</span> <span class="o">&gt;</span> <span class="mf">3.</span> <span class="ow">or</span> <span class="n">mmass</span> <span class="o">&lt;</span> <span class="n">obs_max_mass</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">return</span> <span class="n">eos</span><span class="p">,</span> <span class="n">fam</span></div>



<div class="viewcode-block" id="KNTable"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable">[docs]</a><span class="k">class</span> <span class="nc">KNTable</span><span class="p">(</span><span class="n">Table</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A container for a table of events</span>


<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    astropy.table.Table</span>
<span class="sd">        for details on parameters for creating an `KNTable`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># -- i/o ------------------------------------</span>
<div class="viewcode-block" id="KNTable.read_samples"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.read_samples">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">read_samples</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename_samples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read LALinference posterior_samples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename_samples</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample file supplied does not exist&quot;</span><span class="p">)</span>

        <span class="n">data_out</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename_samples</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;m1_source&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_out</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;m1_source&#39;</span><span class="p">]</span>
            <span class="nb">print</span> <span class="s1">&#39;setting m1 to m1_source&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;m2_source&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_out</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;m2_source&#39;</span><span class="p">]</span>
            <span class="nb">print</span> <span class="s1">&#39;setting m2 to m2_source&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;dlam_tilde&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_out</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;dlambdat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;dlam_tilde&#39;</span><span class="p">]</span>
            <span class="nb">print</span> <span class="s1">&#39;setting dlambdat to dlam_tilde&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;lam_tilde&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_out</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;lambdat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_out</span><span class="p">[</span><span class="s1">&#39;lam_tilde&#39;</span><span class="p">]</span>
            <span class="nb">print</span> <span class="s1">&#39;setting lambdat to lam_tilde&#39;</span>

        <span class="k">return</span> <span class="n">KNTable</span><span class="p">(</span><span class="n">data_out</span><span class="p">)</span></div>


<div class="viewcode-block" id="KNTable.calc_tidal_lambda"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_tidal_lambda">[docs]</a>    <span class="k">def</span> <span class="nf">calc_tidal_lambda</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes posterior samples and calculates lambda1 and lambda2 from</span>
<span class="sd">        lambdat and dlambdat.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="s1">&#39;lambda1&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="s1">&#39;lambda2&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lambda1&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lambda2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tidal_lambda_from_tilde</span><span class="p">(</span>
                                          <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m1&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m2&quot;</span><span class="p">],</span>
                                          <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;lambdat&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;dlambdat&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">remove_negative_lambda</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;You have requested to remove negative lambda values&#39;</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;lambda1&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;lambda2&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
            <span class="nb">print</span> <span class="s2">&quot;Removing </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2"> due to negative lambdas&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">mask</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="KNTable.calc_compactness"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_compactness">[docs]</a>    <span class="k">def</span> <span class="nf">calc_compactness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate compactness of objects from lambda1 and lambda2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">lal</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">G_SI</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">C_SI</span><span class="p">;</span> <span class="n">msun</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">MSUN_SI</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
            <span class="kn">import</span> <span class="nn">astropy.constants</span> <span class="k">as</span> <span class="nn">C</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">G_SI</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">;</span> <span class="n">msun</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">M_sun</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;You have chose to calculate compactness from fit.&#39;</span>
            <span class="nb">print</span> <span class="s1">&#39;you are therefore choosing to be EOS agnostic&#39;</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CLove</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;lambda1&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;c2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CLove</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;lambda2&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;You have chose to calculate compactness from radius.&#39;</span>
            <span class="nb">print</span> <span class="s1">&#39;you are therefore must have selected a EOS&#39;</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">msun</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;c2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">msun</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="KNTable.calc_baryonic_mass"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_baryonic_mass">[docs]</a>    <span class="k">def</span> <span class="nf">calc_baryonic_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">EOS</span><span class="p">,</span> <span class="n">TOV</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if fit=True then the fit from</span>
<span class="sd">        Equation to relate EOS and neutron star mass to Baryonic mass</span>
<span class="sd">        Eq 8: https://arxiv.org/pdf/1708.07714.pdf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;mb1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EOSfit</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m1&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;c1&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;mb2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EOSfit</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m2&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;c2&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="n">TOV</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Monica&#39;</span><span class="p">,</span> <span class="s1">&#39;Wolfgang&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have provided a TOV &#39;</span>
                             <span class="s1">&#39;for which we have no data &#39;</span>
                             <span class="s1">&#39;and therefore cannot &#39;</span>
                             <span class="s1">&#39;calculate the Baryonic mass.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">EOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">get_eos_list</span><span class="p">(</span><span class="n">TOV</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have provided a EOS &#39;</span>
                            <span class="s1">&#39;for which we have no data &#39;</span>
                            <span class="s1">&#39;and therefore cannot &#39;</span>
                            <span class="s1">&#39;calculate the Baryonic mass.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;Monica&#39;</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.MonotonicSpline</span> <span class="k">as</span> <span class="nn">ms</span>
            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.eos_tools</span> <span class="k">as</span> <span class="nn">et</span>
            <span class="n">MassRadiusBaryMassTable</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">find_executable</span><span class="p">(</span><span class="n">EOS</span> <span class="o">+</span> <span class="s1">&#39;_mr.dat&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
            <span class="n">baryonic_mass_of_mass_const</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mb&#39;</span><span class="p">])</span>
            <span class="c1"># after obtaining the baryonic_mass_of_mass constants we now can either take values directly from table or use pre calculated spline to extrapolate the values</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mb&#39;</span><span class="p">],</span> <span class="n">baryonic_mass_of_mass_const</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;mb2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mb&#39;</span><span class="p">],</span> <span class="n">baryonic_mass_of_mass_const</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;Wolfgang&#39;</span><span class="p">:</span>

            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.MonotonicSpline</span> <span class="k">as</span> <span class="nn">ms</span>
            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.eos_tools</span> <span class="k">as</span> <span class="nn">et</span>
            <span class="n">MassRadiusBaryMassTable</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">find_executable</span><span class="p">(</span><span class="n">EOS</span> <span class="o">+</span> <span class="s1">&#39;.tidal.seq&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
            <span class="n">baryonic_mass_of_mass_const</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;grav_mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;baryonic_mass&#39;</span><span class="p">])</span>
            <span class="c1"># after obtaining the baryonic_mass_of_mass constants we now can either take values directly from table or use pre calculated spline to extrapolate the values</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;grav_mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;baryonic_mass&#39;</span><span class="p">],</span> <span class="n">baryonic_mass_of_mass_const</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;mb2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;grav_mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;baryonic_mass&#39;</span><span class="p">],</span> <span class="n">baryonic_mass_of_mass_const</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="KNTable.calc_radius"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_radius">[docs]</a>    <span class="k">def</span> <span class="nf">calc_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">EOS</span><span class="p">,</span> <span class="n">TOV</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">TOV</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Monica&#39;</span><span class="p">,</span> <span class="s1">&#39;Wolfgang&#39;</span><span class="p">,</span> <span class="s1">&#39;lalsim&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have provided a TOV &#39;</span>
                             <span class="s1">&#39;for which we have no data &#39;</span>
                             <span class="s1">&#39;and therefore cannot &#39;</span>
                             <span class="s1">&#39;calculate the radius.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">EOS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">get_eos_list</span><span class="p">(</span><span class="n">TOV</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You have provided a EOS &#39;</span>
                            <span class="s1">&#39;for which we have no data &#39;</span>
                            <span class="s1">&#39;and therefore cannot &#39;</span>
                            <span class="s1">&#39;calculate the radius.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;Monica&#39;</span><span class="p">:</span>

            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.MonotonicSpline</span> <span class="k">as</span> <span class="nn">ms</span>
            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.eos_tools</span> <span class="k">as</span> <span class="nn">et</span>
            <span class="n">MassRadiusBaryMassTable</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">find_executable</span><span class="p">(</span><span class="n">EOS</span> <span class="o">+</span> <span class="s1">&#39;_mr.dat&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
            <span class="n">radius_of_mass_const</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span>
            <span class="c1"># after obtaining the radius_of_mass constants we now can either take values directly from table or use pre calculated spline to extrapolate the values</span>
            <span class="c1"># also radius is in km in table. need to convert to SI (i.e. meters)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">radius_of_mass_const</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">radius_of_mass_const</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

        <span class="k">elif</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;Wolfgang&#39;</span><span class="p">:</span>

            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.MonotonicSpline</span> <span class="k">as</span> <span class="nn">ms</span>
            <span class="kn">import</span> <span class="nn">gwemlightcurves.EOS.TOV.Monica.eos_tools</span> <span class="k">as</span> <span class="nn">et</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">lal</span>
                <span class="n">G</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">G_SI</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">C_SI</span><span class="p">;</span> <span class="n">msun</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">MSUN_SI</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
                <span class="kn">import</span> <span class="nn">astropy.constants</span> <span class="k">as</span> <span class="nn">C</span>
                <span class="n">G</span> <span class="o">=</span> <span class="n">lal</span><span class="o">.</span><span class="n">G_SI</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">;</span> <span class="n">msun</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">M_sun</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="p">)</span>

            <span class="n">MassRadiusBaryMassTable</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">find_executable</span><span class="p">(</span><span class="n">EOS</span> <span class="o">+</span> <span class="s1">&#39;.tidal.seq&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
            <span class="n">radius_of_mass_const</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;grav_mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;Circumferential_radius&#39;</span><span class="p">])</span>
            <span class="n">unit_conversion</span> <span class="o">=</span> <span class="p">(</span><span class="n">msun</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;grav_mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;Circumferential_radius&#39;</span><span class="p">],</span> <span class="n">radius_of_mass_const</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_conversion</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;grav_mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;Circumferential_radius&#39;</span><span class="p">],</span> <span class="n">radius_of_mass_const</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_conversion</span>

        <span class="k">elif</span> <span class="n">TOV</span> <span class="o">==</span> <span class="s1">&#39;lalsim&#39;</span><span class="p">:</span>

            <span class="kn">import</span> <span class="nn">lalsimulation</span> <span class="k">as</span> <span class="nn">lalsim</span>
            <span class="n">MassRadiusiBaryMassTable</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">find_executable</span><span class="p">(</span><span class="n">EOS</span> <span class="o">+</span> <span class="s1">&#39;_lalsim_mr.dat&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
            <span class="n">radius_of_mass_const</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span>
            <span class="c1"># after obtaining the radius_of_mass constants we now can either take values directly from table or use pre calculated spline to extrapolate the values</span>
            <span class="c1"># also radius is in km in table. need to convert to SI (i.e. meters)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">radius_of_mass_const</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">et</span><span class="o">.</span><span class="n">values_from_table</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">MassRadiusBaryMassTable</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">radius_of_mass_const</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="KNTable.downsample"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.downsample">[docs]</a>    <span class="k">def</span> <span class="nf">downsample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nsamples</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        randomly down samples the number os posterior samples used for calculating lightcurves</span>
<span class="sd">        plotting etc</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You are requesting to downsample the number of posterior samples to </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Nsamples</span><span class="p">))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m1&quot;</span><span class="p">]))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[:</span><span class="n">Nsamples</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>


<div class="viewcode-block" id="KNTable.plot_mag_panels"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.plot_mag_panels">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">plot_mag_panels</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">table_dict</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">filts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="s2">&quot;i&quot;</span><span class="p">,</span><span class="s2">&quot;z&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;J&quot;</span><span class="p">,</span><span class="s2">&quot;H&quot;</span><span class="p">,</span><span class="s2">&quot;K&quot;</span><span class="p">],</span>  <span class="n">magidxs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">28</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This allows us to take the lightcurves from the KNModels samples table and plot it</span>
<span class="sd">        using a supplied set of filters. Default: filts=[&quot;g&quot;,&quot;r&quot;,&quot;i&quot;,&quot;z&quot;,&quot;y&quot;,&quot;J&quot;,&quot;H&quot;,&quot;K&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get legend determines the names to add to legend based on KN model</span>
        <span class="k">def</span> <span class="nf">get_legend</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;DiUj2017&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Dietrich and Ujevic (2017)&quot;</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;KaKy2016&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Kawaguchi et al. (2016)&quot;</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;Me2017&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Metzger (2017)&quot;</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;SmCh2017&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Smartt et al. (2017)&quot;</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;WoKo2017&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Wollaeger et al. (2017)&quot;</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;BaKa2016&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Barnes et al. (2016)&quot;</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;Ka2017&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Kasen (2017)&quot;</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;RoFe2017&quot;</span><span class="p">:</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="s2">&quot;Rosswog et al. (2017)&quot;</span>

            <span class="k">return</span> <span class="n">legend_name</span>

        <span class="kn">import</span> <span class="nn">matplotlib</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="k">import</span> <span class="n">cm</span>


        <span class="c1"># Initialize variables and arrays</span>
        <span class="n">models</span> <span class="o">=</span> <span class="n">table_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">colors_names</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)))</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">table_dict</span><span class="p">[</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;tini&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;tmax&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;dt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">table_dict</span><span class="p">[</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;dt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Initialize plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span><span class="p">)</span>

        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">filt</span><span class="p">,</span> <span class="n">magidx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">filts</span><span class="p">,</span> <span class="n">magidxs</span><span class="p">):</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d%d%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filts</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cnt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
                <span class="n">legend_name</span> <span class="o">=</span> <span class="n">get_legend</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

                <span class="n">magmed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">table_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s2">&quot;mag_</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">filt</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">magmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">table_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s2">&quot;mag_</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">filt</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">magmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">table_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s2">&quot;mag_</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">filt</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">magmed</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors_names</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">legend_name</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">magmin</span><span class="p">,</span> <span class="n">magmax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colors_names</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">filt</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">18.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">},</span> <span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

                <span class="n">ax3</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>   <span class="c1"># mirror them</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">app</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">distance</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax4</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>   <span class="c1"># mirror them</span>
                <span class="n">ax4</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">app</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">distance</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">ax4</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">cnt</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">filts</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [days]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span></div>

<div class="viewcode-block" id="KNTable.mass_cut"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.mass_cut">[docs]</a>    <span class="k">def</span> <span class="nf">mass_cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mass2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mtotmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mtotmax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform mass cut on table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print(&#39;You are requesting to remove samples with m1 above %.2f solar masses and m2 above %.2f solar masses&#39;%(mass1,mass2))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">mass1</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m1&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">mass1</span><span class="p">)</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mass2</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m2&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">mass2</span><span class="p">)</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mtotmin</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m1&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m2&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">mtotmin</span><span class="p">)</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mtotmax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m1&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;m2&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">mtotmax</span><span class="p">)</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="KNTable.model"><a class="viewcode-back" href="../../../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.model">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">format_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fetch a table of events from a database</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        *args</span>
<span class="sd">            all other positional arguments are specific to the</span>
<span class="sd">            data format, see below for basic usage</span>

<span class="sd">        **kwargs</span>
<span class="sd">            all other positional arguments are specific to the</span>
<span class="sd">            data format, see the online documentation for more details</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `KNTable`</span>
<span class="sd">            a table of events recovered from the remote database</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Notes</span>
<span class="sd">        -----&quot;&quot;&quot;</span>
        <span class="c1"># standard registered fetch</span>
        <span class="kn">from</span> <span class="nn">.io.model</span> <span class="k">import</span> <span class="n">get_model</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="n">format_</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Scott Coughlin.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0+untagged.134.gbc97269.dirty',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>