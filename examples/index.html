

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Simulating a Kilonova Lightcurve &mdash; gwemlightcurves 0+untagged.115.g3750a5e.dirty documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/gwemlightcurves-docs.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="gwemlightcurves 0+untagged.115.g3750a5e.dirty documentation" href="../index.html"/>
        <link rel="next" title="Lightcurves" href="lightcurves.html"/>
        <link rel="prev" title="Welcome to gwemlightcurves’s documentation!" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gwemlightcurves
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.115.g3750a5e.dirty
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Simulating a Kilonova Lightcurve</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reading-and-using-kntable">Reading and using KNTable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-compactness">Calculating Compactness</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-baryonic-mass">Calculating Baryonic Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-ejecta-mass-and-velocity-of-ejecta">Calculating Ejecta Mass and Velocity of Ejecta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-light-curves">Generating Light Curves</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lightcurves.html">Lightcurves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../command-line/index.html">Running <code class="docutils literal"><span class="pre">run_parameterized_models_event.py</span></code> on the command line</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gwemlightcurves</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Simulating a Kilonova Lightcurve</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="simulating-a-kilonova-lightcurve">
<span id="examples"></span><h1>Simulating a Kilonova Lightcurve<a class="headerlink" href="#simulating-a-kilonova-lightcurve" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>When attempting to simulate the lightcurve froma kilonova assosciated with a binary coalesence, a number of parameters must be determine first. First of all, is the system a binary neutron star system or a neutron star black hole system. This determination will effect which fit model you utilize in order to calculate the expected dynamical ejecta mass (and velocity) that arises from the system. For binary neutron stars, one can use <a class="reference external" href="https://arxiv.org/pdf/1612.03665.pdf#equation.3.1">Tim Dietrich and Maximiliano Ujevic</a>, and for a NSBH one can use <a class="reference external" href="https://arxiv.org/abs/1601.07711">Kawaguchi</a>. These fits tie information such as compactness, baryonic mass, and mass of the objects to the expected ejecta. These fits come with uncertainities of ~72% but knowing the ejecta mass is critical when determining the expected lightcurve from the resulting kilonova. We now explain how one can go froma  set of posteriors of the system to generating the expected lightcurve from the kilonova. We consider many important things including whether or not you make Equation of State (EOS) assumptions. Whether or not you use fits for compactness and baryonic mass and how you treat the uncertainity in ejecta that comes with the fit.</p>
<div class="section" id="reading-and-using-kntable">
<h3>Reading and using KNTable<a class="headerlink" href="#reading-and-using-kntable" title="Permalink to this headline">¶</a></h3>
<p>The <cite>KNTable</cite> object comes with a <a class="reference internal" href="../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.read_samples" title="gwemlightcurves.KNModels.table.KNTable.read_samples"><code class="xref py py-meth docutils literal"><span class="pre">read_samples()</span></code></a>, allowing
trivial reading of samples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.KNModels</span> <span class="k">import</span> <span class="n">KNTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The results should look like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">   dlambdat     costheta_jn   ...      dec       matched_filter_snr</span>
<span class="go">-------------- -------------- ... -------------- ------------------</span>
<span class="go">-424.431604646 0.848696760069 ... 0.577824127959      33.5477773932</span>
<span class="go">-147.120517819 0.991997169733 ... 0.576384671836      33.5566982929</span>
<span class="go">-240.912505017 0.976047933498 ... 0.577896147804      33.6263488512</span>
<span class="go">-186.290687306 0.727047513491 ... 0.582878134524      33.4518918366</span>
<span class="go">-210.457602464 0.967621722464 ... 0.580780890411      33.5696948608</span>
<span class="go">0.377168713485 0.653066039319 ...  0.57000694353      33.5307165083</span>
<span class="go">-350.294734561 0.891785128102 ... 0.585910104721      33.5685077643</span>
<span class="go">           ...            ... ...            ...                ...</span>
<span class="go">-37.5863972893 0.975612607455 ... 0.575280574082      33.6140080488</span>
<span class="go">-128.526058992 0.698513990317 ... 0.581271675244      33.5713366289</span>
<span class="go">-10.3419873355 0.971274339543 ... 0.576536076406      33.6291236021</span>
<span class="go"> 202.992550229 0.967479803846 ... 0.571265399682      33.5992585584</span>
<span class="go">-21.5943515138 0.673295017122 ... 0.578523325358      33.3765394973</span>
<span class="go"> 82.6149783838 0.941362067895 ... 0.582807999184      33.5504875571</span>
<span class="go"> -490.19334394  0.83602530718 ... 0.564811075217      33.6087938033</span>
<span class="go">Length = 1996 rows</span>
</pre></div>
</div>
<p>After loading the table, one can caluclate lambda1 and lambda2 from dtilde if it is not already in the samples.
<a class="reference internal" href="../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_tidal_lambda" title="gwemlightcurves.KNModels.table.KNTable.calc_tidal_lambda"><code class="xref py py-meth docutils literal"><span class="pre">calc_tidal_lambda()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>After accomplishing the reading of the sample, let’s say we want to calculate
compactness from radius. This would require calculating the radius from a mass radius curve. We can use <code class="xref py py-meth docutils literal"><span class="pre">gwemlightcurves.KNModels.KNTable.calc_radius()</span></code>. In this module we have a number of ways to accomplish this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_wolf</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Wolfgang&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_lalsim</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;lalsim&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>After this we can now calculate the compactness <a class="reference internal" href="../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_compactness" title="gwemlightcurves.KNModels.table.KNTable.calc_compactness"><code class="xref py py-meth docutils literal"><span class="pre">calc_compactness()</span></code></a>.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span> <span class="o">=</span> <span class="n">t_sly_mon</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_wolf</span> <span class="o">=</span> <span class="n">t_sly_wolf</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_lalsim</span> <span class="o">=</span> <span class="n">t_sly_lalsim</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
</pre></div>
</div>
<p>After this we can calulcate the baryonic mass. Now we can either use the calculated compactness and have it be EOS dependent of calculate the baryonic mass using a fit using <a class="reference internal" href="../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.calc_baryonic_mass" title="gwemlightcurves.KNModels.table.KNTable.calc_baryonic_mass"><code class="xref py py-meth docutils literal"><span class="pre">calc_baryonic_mass()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span> <span class="o">=</span> <span class="n">t_sly_mon</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;ap4&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_wolf</span> <span class="o">=</span> <span class="n">t_sly_wolf</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;ap4&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Wolfgang&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_lalsim</span> <span class="o">=</span> <span class="n">t_sly_lalsim</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;ap4&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;lalsim&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon_bary_from_fit</span> <span class="o">=</span> <span class="n">t_sly_mon</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculating-compactness">
<h3>Calculating Compactness<a class="headerlink" href="#calculating-compactness" title="Permalink to this headline">¶</a></h3>
<p>Let’s Demonstrate some of the differences between calculating compactness from fit (i.e. being EOS agnostic) versus calculating it from a EOS.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.KNModels</span> <span class="k">import</span> <span class="n">KNTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwpy.table</span> <span class="k">import</span> <span class="n">EventTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwpy.plotter</span> <span class="k">import</span> <span class="n">EventTablePlot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">EventTablePlot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EOS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ap3&#39;</span><span class="p">,</span> <span class="s1">&#39;ap4&#39;</span><span class="p">,</span> <span class="s1">&#39;eng&#39;</span><span class="p">,</span> <span class="s1">&#39;gnh3&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;mpa1&#39;</span><span class="p">,</span> <span class="s1">&#39;ms1&#39;</span><span class="p">,</span> <span class="s1">&#39;ms1b&#39;</span><span class="p">,</span> <span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="s1">&#39;wff1&#39;</span><span class="p">,</span> <span class="s1">&#39;wff2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;chartreuse&#39;</span><span class="p">,</span> <span class="s1">&#39;burlywood&#39;</span><span class="p">,</span> <span class="s1">&#39;lightseagreen&#39;</span><span class="p">,</span> <span class="s1">&#39;mediumaquamarine&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EOS_Color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span> <span class="n">Color</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">eos</span> <span class="ow">in</span> <span class="n">EOS</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">t_radius</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="n">eos</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">t_radius_compact</span> <span class="o">=</span> <span class="n">t_radius</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">t_radius_compact</span> <span class="o">=</span> <span class="n">EventTable</span><span class="p">(</span><span class="n">t_radius_compact</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">t_radius_compact</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">],</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Compactness From </span><span class="si">{0}</span><span class="s1"> Table&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eos</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">EOS_Color</span><span class="p">[</span><span class="n">eos</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_comp_fit</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">t_comp_fit</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">],</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Compactness From Fit&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Compactness&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Rate&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Compactness Values&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-1.py">Source code</a>, <a class="reference external" href="../examples/index-1.png">png</a>, <a class="reference external" href="../examples/index-1.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/index-1.png" src="../_images/index-1.png" />
</div>
</div>
<div class="section" id="calculating-baryonic-mass">
<h3>Calculating Baryonic Mass<a class="headerlink" href="#calculating-baryonic-mass" title="Permalink to this headline">¶</a></h3>
<p>Let’s demonstrate some of the differences between calculating the baryonic_mass from fit versus calculating it from an EOS table.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.KNModels</span> <span class="k">import</span> <span class="n">KNTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwpy.table</span> <span class="k">import</span> <span class="n">EventTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwpy.plotter</span> <span class="k">import</span> <span class="n">EventTablePlot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">Nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">Nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">EventTablePlot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EOS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ap3&#39;</span><span class="p">,</span> <span class="s1">&#39;ap4&#39;</span><span class="p">,</span> <span class="s1">&#39;eng&#39;</span><span class="p">,</span> <span class="s1">&#39;gnh3&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;mpa1&#39;</span><span class="p">,</span> <span class="s1">&#39;ms1&#39;</span><span class="p">,</span> <span class="s1">&#39;ms1b&#39;</span><span class="p">,</span> <span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="s1">&#39;wff1&#39;</span><span class="p">,</span> <span class="s1">&#39;wff2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;chartreuse&#39;</span><span class="p">,</span> <span class="s1">&#39;burlywood&#39;</span><span class="p">,</span> <span class="s1">&#39;lightseagreen&#39;</span><span class="p">,</span> <span class="s1">&#39;mediumaquamarine&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_location</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span> <span class="n">locations</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EOS_Color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span> <span class="n">Color</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">eos</span> <span class="ow">in</span> <span class="n">EOS</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">plot_location</span><span class="p">[</span><span class="n">eos</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">plot_location</span><span class="p">[</span><span class="n">eos</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">plot_location</span><span class="p">[</span><span class="n">eos</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EOS: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eos</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">fit</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="n">eos</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact</span> <span class="o">=</span> <span class="n">t_radius</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact_bary</span> <span class="o">=</span> <span class="n">t_radius_compact</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="n">eos</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">fit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact_bary</span> <span class="o">=</span> <span class="n">EventTable</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bary From Fit&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">EOS_Color</span><span class="p">[</span><span class="n">eos</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bary From Table&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">EOS_Color</span><span class="p">[</span><span class="n">eos</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EOS Independent&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plot</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="s1">&#39;Mass of Larger Object&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Baryonic Mass of Larger Object&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Mass by Baryonic Mass of Larger Object&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-2.py">Source code</a>, <a class="reference external" href="../examples/index-2.png">png</a>, <a class="reference external" href="../examples/index-2.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/index-2.png" src="../_images/index-2.png" />
</div>
</div>
<div class="section" id="calculating-ejecta-mass-and-velocity-of-ejecta">
<h3>Calculating Ejecta Mass and Velocity of Ejecta<a class="headerlink" href="#calculating-ejecta-mass-and-velocity-of-ejecta" title="Permalink to this headline">¶</a></h3>
<p>Now that we have compactness and the baryonic mass we can calculate Mass of the ejecta and the velocity of the ejecta using fits from Tim Dietrich and Maximiliano Ujevic</p>
<p>The dynamical ejecta mass fit formula can be found</p>
<p><a class="reference external" href="https://arxiv.org/pdf/1612.03665.pdf#equation.3.1">https://arxiv.org/pdf/1612.03665.pdf#equation.3.1</a></p>
<p>and the constants are taken from</p>
<p><a class="reference external" href="https://arxiv.org/pdf/1612.03665.pdf#equation.3.2">https://arxiv.org/pdf/1612.03665.pdf#equation.3.2</a></p>
<p>The method used to calculate in this repo is <a class="reference internal" href="../api/gwemlightcurves.EjectaFits.DiUj2017.html#gwemlightcurves.EjectaFits.DiUj2017.calc_meje" title="gwemlightcurves.EjectaFits.DiUj2017.calc_meje"><code class="xref py py-meth docutils literal"><span class="pre">gwemlightcurves.EjectaFits.DiUj2017.calc_meje()</span></code></a> and can be used as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.EjectaFits.DiUj2017</span> <span class="k">import</span> <span class="n">calc_meje</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.KNModels</span> <span class="k">import</span> <span class="n">KNTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span> <span class="o">=</span> <span class="n">t_sly_mon</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span> <span class="o">=</span> <span class="n">t_sly_mon</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_meje</span><span class="p">(</span><span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;mb2&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;c2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The velocity of the ejecta mass fit can be found:</p>
<p><a class="reference external" href="https://arxiv.org/pdf/1612.03665.pdf#equation.3.9">https://arxiv.org/pdf/1612.03665.pdf#equation.3.9</a></p>
<p>The method used to calculate in this repo is <a class="reference internal" href="../api/gwemlightcurves.EjectaFits.DiUj2017.html#gwemlightcurves.EjectaFits.DiUj2017.calc_vej" title="gwemlightcurves.EjectaFits.DiUj2017.calc_vej"><code class="xref py py-meth docutils literal"><span class="pre">gwemlightcurves.EjectaFits.DiUj2017.calc_vej()</span></code></a> and can be used as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.EjectaFits.DiUj2017</span> <span class="k">import</span> <span class="n">calc_vej</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_vej</span><span class="p">(</span><span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_sly_mon</span><span class="p">[</span><span class="s1">&#39;c2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.EjectaFits.DiUj2017</span> <span class="k">import</span> <span class="n">calc_meje</span><span class="p">,</span> <span class="n">calc_vej</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.KNModels</span> <span class="k">import</span> <span class="n">KNTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwpy.table</span> <span class="k">import</span> <span class="n">EventTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwpy.plotter</span> <span class="k">import</span> <span class="n">EventTablePlot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">Nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">Nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">EventTablePlot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EOS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ap3&#39;</span><span class="p">,</span> <span class="s1">&#39;ap4&#39;</span><span class="p">,</span> <span class="s1">&#39;eng&#39;</span><span class="p">,</span> <span class="s1">&#39;gnh3&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;mpa1&#39;</span><span class="p">,</span> <span class="s1">&#39;ms1&#39;</span><span class="p">,</span> <span class="s1">&#39;ms1b&#39;</span><span class="p">,</span> <span class="s1">&#39;sly&#39;</span><span class="p">,</span> <span class="s1">&#39;wff1&#39;</span><span class="p">,</span> <span class="s1">&#39;wff2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;chartreuse&#39;</span><span class="p">,</span> <span class="s1">&#39;burlywood&#39;</span><span class="p">,</span> <span class="s1">&#39;lightseagreen&#39;</span><span class="p">,</span> <span class="s1">&#39;mediumaquamarine&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">locations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_location</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span> <span class="n">locations</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EOS_Color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">EOS</span><span class="p">,</span> <span class="n">Color</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span> <span class="o">=</span> <span class="n">t_indepedent</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_meje</span><span class="p">(</span><span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;mb2&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;c2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">eos</span> <span class="ow">in</span> <span class="n">EOS</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">plot_location</span><span class="p">[</span><span class="n">eos</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">plot_location</span><span class="p">[</span><span class="n">eos</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">plot_location</span><span class="p">[</span><span class="n">eos</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EOS: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eos</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">fit</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_radius</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="n">eos</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact</span> <span class="o">=</span> <span class="n">t_radius</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact_bary</span> <span class="o">=</span> <span class="n">t_radius_compact</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="n">eos</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="s1">&#39;Monica&#39;</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">fit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_meje</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mb1&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mb2&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;c2&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">t_radius_compact_bary</span> <span class="o">=</span> <span class="n">EventTable</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bary From Fit&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">EOS_Color</span><span class="p">[</span><span class="n">eos</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_radius_compact_bary</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bary From Table&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">EOS_Color</span><span class="p">[</span><span class="n">eos</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plot</span><span class="o">.</span><span class="n">add_scatter</span><span class="p">(</span><span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">],</span> <span class="n">t_indepedent</span><span class="p">[</span><span class="s1">&#39;mej&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EOS Independent&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plot</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="s1">&#39;Mass of Smaller Object&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Ejecta Mass&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Smaller Mass by Ejecta Mass&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-3.py">Source code</a>, <a class="reference external" href="../examples/index-3.png">png</a>, <a class="reference external" href="../examples/index-3.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-3.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/index-3.png" src="../_images/index-3.png" />
</div>
</div>
<div class="section" id="generating-light-curves">
<h3>Generating Light Curves<a class="headerlink" href="#generating-light-curves" title="Permalink to this headline">¶</a></h3>
<p>Finally, let’s calculate a lightcurve being EOS agnostic. That is, we calculate both the compactness and baryonic masses from fits. Also let us look at a Metzer 2017 and DiUj2017 models. In order to take a set of samples and calculate the light curves that would result from a realization of each sample you can you the <a class="reference internal" href="../api/gwemlightcurves.KNModels.table.html#gwemlightcurves.KNModels.table.KNTable.model" title="gwemlightcurves.KNModels.table.KNTable.model"><code class="xref py py-class docutils literal"><span class="pre">model</span></code></a> which takes as inputs the string name of the model and the table of samples containing at minimum compactness and baryonic mass (it can clauclate mass ejecta and velocity of ejecta on the fly)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves.KNModels</span> <span class="k">import</span> <span class="n">KNTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gwemlightcurves</span> <span class="k">import</span> <span class="n">lightcurve_utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="s1">&#39;posterior_samples.dat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_tidal_lambda</span><span class="p">(</span><span class="n">remove_negative_lambda</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_compactness</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">calc_baryonic_mass</span><span class="p">(</span><span class="n">EOS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TOV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">Nsamples</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tini</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">;</span> <span class="n">th</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span> <span class="n">ph</span> <span class="o">=</span> <span class="mf">3.14</span><span class="p">;</span> <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.58</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">);</span> <span class="n">alp</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">;</span> <span class="n">eth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">flgbct</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span> <span class="n">kappa_r</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">slope_r</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">;</span> <span class="n">theta_r</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">Ye</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;tini&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tini</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;tmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmax</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;vmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;th&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;ph&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ph</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kappa</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;eps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eps</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;alp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alp</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;eth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eth</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;flgbct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flgbct</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;kappa_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kappa_r</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;slope_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slope_r</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;theta_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_r</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;Ye&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ye</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create dict of tables for the various models, calculating mass ejecta velocity of ejecta and the lightcurve from the model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DiUj2017&quot;</span><span class="p">,</span><span class="s2">&quot;Me2017&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_tables</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model_tables</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we need to do some interpolation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">model_tables</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">lightcurve_utils</span><span class="o">.</span><span class="n">calc_peak_mags</span><span class="p">(</span><span class="n">model_tables</span><span class="p">[</span><span class="n">model</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">model_tables</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">lightcurve_utils</span><span class="o">.</span><span class="n">interpolate_mags_lbol</span><span class="p">(</span><span class="n">model_tables</span><span class="p">[</span><span class="n">model</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1">#Mpc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="o">=</span> <span class="n">KNTable</span><span class="o">.</span><span class="n">plot_mag_panels</span><span class="p">(</span><span class="n">model_tables</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-4.py">Source code</a>, <a class="reference external" href="../examples/index-4.png">png</a>, <a class="reference external" href="../examples/index-4.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/index-4.png" src="../_images/index-4.png" />
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lightcurves.html" class="btn btn-neutral float-right" title="Lightcurves" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Welcome to gwemlightcurves’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Scott Coughlin.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0+untagged.115.g3750a5e.dirty',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>